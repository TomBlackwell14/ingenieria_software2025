{% extends "base.html" %}
{% block title %}Iniciar sesion · Cencosud Gases Free!{% endblock %}

{% block content %}
<div class="page">

  <!-- IZQUIERDA: BRAND + OLITAS MAS CERCA -->
  <section class="brand vcenter">
    <div class="brand-head">
      <span class="brand-pill">🍃</span>
      <h1>Cencosud Gases Free!</h1>
    </div>
    <p class="brand-sub">Gestion y seguimiento de Carbono Neutralidad</p>

    <!-- OLITAS SVG CERCA DEL TITULO -->
    <svg class="waves near" viewBox="0 0 600 200" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,140 C120,190 240,90 360,140 C480,190 540,120 600,150 L600,200 L0,200 Z" opacity="0.10" fill="#fff"/>
      <path d="M0,150 C130,110 230,200 360,150 C470,110 530,170 600,150 L600,200 L0,200 Z" opacity="0.07" fill="#fff"/>
    </svg>
  </section>

  <!-- DERECHA: CARD LOGIN -->
  <section class="card vcenter right login-card">
    <header class="card-header">
      <h3>Iniciar sesion</h3>
      <small>Selecciona tu rol para continuar</small>
    </header>

    <div class="roles-grid" id="roles">
      <button class="role" type="button" data-role="director">
        <div class="role-top"><span class="icon">🎯</span><span class="check">✓</span></div>
        <h4>Director</h4>
        <p>Vision estrategica y aprobacion global</p>
      </button>

      <button class="role" type="button" data-role="analista">
        <div class="role-top"><span class="icon">📊</span><span class="check">✓</span></div>
        <h4>Analista Ambiental</h4>
        <p>Coordinacion y supervision de operaciones</p>
      </button>

      <button class="role" type="button" data-role="operador">
        <div class="role-top"><span class="icon">🔧</span><span class="check">✓</span></div>
        <h4>Operario</h4>
        <p>Ejecucion de tareas operativas</p>
      </button>

      <button class="role" type="button" data-role="ciudadano">
        <div class="role-top"><span class="icon">🧑‍🤝‍🧑</span><span class="check">✓</span></div>
        <h4>Ciudadano</h4>
        <p>Acceso publico a informacion</p>
      </button>
    </div>

    <button id="go" class="btn primary" disabled>Iniciar sesion</button>
    <div class="links"><a href="/accounts/password_reset/">¿Has perdido la contrasena?</a></div>

    <div class="bubbles" aria-hidden="true"></div>
  </section>
</div>

<script>
(function(){
  let selected = null;
  const roles = document.querySelectorAll('.role');
  const btn = document.getElementById('go');

  roles.forEach(r => {
    r.addEventListener('click', () => {
      roles.forEach(x => x.classList.remove('active'));
      r.classList.add('active');
      selected = r.getAttribute('data-role');
      btn.disabled = false;
    });
  });

  btn.addEventListener('click', () => {
    if (!selected) return;
    if (selected === 'ciudadano') {
      window.location.href = '/dashboard/ciudadano/';
      return;
    }
    const next = encodeURIComponent(`/dashboard/${selected}/`);
    window.location.href = `/accounts/login/?next=${next}`;
  });
})();
</script>
{% endblock %}
